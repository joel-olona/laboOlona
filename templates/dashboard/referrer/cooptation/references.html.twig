{% extends 'dashboard/base.html.twig' %}

{% block title %}Mes références{% endblock %}

{% block body %}
{% set defaultRewards = annonce.salaire / 10 %}
<div class="container">
    <div class="annonce-list p-2">
        <div class="annonce-item shadow p-md-5 m-md-4">
            <h1 class="card-title h2 text-info">{{ annonce.titre }}</h1>
            <p class="text-muted small">
                <i class="bi bi-circle-fill small mx-2 text-danger"></i> {{ annonce.status }} 
                    <span class="small text-center mx-3">|</span>
                {{ annonce.typeContrat }} 
                    <span class="small text-center mx-3">|</span>
                <i class="bi bi-geo-alt-fill"></i> {{ annonce.lieu }} 
                    <span class="small text-center mx-3">|</span>
                <i class="bi bi-hourglass-split"></i> Expire le {{ annonce.dateExpiration|date('d/m/Y') }}
                    <span class="small text-center mx-3">|</span>
                <i class="bi bi-eye"></i> {{ annonce.annonceVues|length }} vues
                    <span class="small text-center mx-3">|</span>
                <i class="bi bi-cash-stack"></i> {{ defaultRewards }} €
            </p>
            {% if referrals|length > 0 %}
            <div class="container">
                <div class="row text-strong">
                    <div class="col-sm-4">Email</div>
                    <div class="col-sm-8">
                        <div class="row">
                            <div class="col-sm-6 col-md-3 text-center">Creation</div>
                            <div class="col-sm-6 col-md-3">Status</div>
                            <div class="col-sm-6 col-md-3">Code</div>
                            <div class="col-sm-6 col-md-3 text-center">Prime</div>
                        </div>
                    </div>
                </div>
                <hr>
                {% for item in referrals %}
                    {% set rewards = defaultRewards %}
                    {% if item.rewards is not null %}
                    {% set rewards = item.rewards %}
                    {% endif %}
                    <div class="row text-muted">
                        <div class="col-sm-4">
                            {{ item.referredEmail}} <br>
                            <span class="text-dark small"> Étape :</span> {{stepCooptation(item.step)|raw}}    
                        </div>
                        <div class="col-sm-8">
                            <div class="row">
                                <div class="col-sm-6 col-md-3 text-center">
                                    {{ item.createdAt|time_ago }}
                                </div>
                                <div class="col-sm-6 col-md-3">{{ item.status }}</div>
                                <div class="col-sm-6 col-md-3 small">{{ item.referralCode }}</div>
                                <div class="col-sm-6 col-md-3 text-center">{{ item.rewards }} €</div>
                            </div>
                        </div>
                    </div>                    
                    <hr>                    
                {% endfor %}
            <!-- Plus de lignes et colonnes ici -->
            </div>
            <div class="navigation mt-5">
                {{ knp_pagination_render(referrals, 'parts/_pagination.html.twig') }}
            </div>
            {% else %}
            <div class="container p-5 m-5 text-center">
                Vous n'avez effectuer aucune recommandation pour le moment <br>
                <a href="{{path('app_dashboard_referrer_annonces')}}" class="btn btn-primary mx-5">Toutes les annonces</a>
            </div>
            {% endif %}


        </div>
    </div>
</div>
{% endblock %}
